steps:
    - template: setup_node.yml

    - script: cat patches/*.patch | md5sum > patches/lock
      displayName: Generate patch lock file

    - task: Cache@2
      inputs:
          key: 'yarn | "$(Agent.OS)" | yarn.lock | patches/lock'
          path: $(Build.SourcesDirectory)/node_modules
      displayName: Cache yarn dependencies

    - script: yarn install --frozen-lockfile
      displayName: Install dependencies
